<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SooshARPG | ARPG Mod Tools</title>
  <link rel="shortcut icon" type="image/png" href="img/favicon.png"/>
  
  <!-- CSS Stylesheet -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/mod.css" />
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-md-6 col-md-offset-3">
        <div class="well well-sm">
          <form class="form-horizontal" action="" method="post">
          <fieldset>
            <legend class="text-center">Dailies Rolling</legend>
            
            <!-- DailyType input-->
            <div class="form-group">
              <label class="col-md-3 control-label" for="dailyType">Daily Type</label>
              <div class="col-md-9">
                <select id="dailyType" class="form-control">
                  <option value="crafting">Crafting</option>
                  <option value="hunting">Hunting</option>
                  <option value="fishing">Angling</option>
                  <option value="mining">Mining</option>
                  <option value="woodcutting">Woodcutting</option>
                  <option value="gathering">Gathering</option>
                </select>
              </div>
            </div>
    
            <!-- Location input-->
            <div class="form-group">
              <label class="col-md-3 control-label" for="locationType">Location</label>
              <div class="col-md-9">
                <select id="locationType" class="form-control">
                  <option value="thickets">The Thickets</option>
                  <option value="midwoods">The Midwoods</option>
                  <option value="thorns">The Thorns</option>
                  <option value="solitude">Mount Solitude</option>
                  <option value="reflections">Lake of Reflections</option>
                </select>
              </div>
            </div>
            
            <!-- Name input-->
            <div class="form-group">
              <label class="col-md-3 control-label" for="sooshName">Soosh's Name</label>
              <div class="col-md-9">
                <input type="text" class="form-control" id="sooshName">
              </div>
            </div>
            
            <!-- Soosh Skill input-->
            <div class="form-group">
              <label class="col-md-3 control-label" for="skillLevel">Soosh's Skill Level</label>
              <div class="col-md-9">
                <select id="skillLevel" class="form-control">
                  <option value="0">Novice/Rookie</option>
                  <option value="1">Apprentice</option>
                  <option value="2">Whiz</option>
                  <option value="3">Genius</option>
                  <option value="4">Master</option>
                  <option value="5">Hero</option>
                </select>
              </div>
            </div>
    
            <!-- Button -->
            <div class="form-group">
              <div class="col-md-12 text-right">
                <button type="button" class="btn btn-primary btn-block" onclick="rollDaily()">Roll Daily</button>
              </div>
            </div>
            
            <!-- Daily Result textarea -->
            <div class="form-group">
              <label class="col-md-3 control-label" for="dailyOutput">Daily Result</label>
              <div class="col-md-9">
                <textarea class="form-control" id="dailyOutput" name="message" rows="5"></textarea>
              </div>
            </div>
            
            <!-- Daily Result textarea -->
            <div class="form-group">
              <label class="col-md-3 control-label" for="formalOutput">Formal Result</label>
              <div class="col-md-9">
                <textarea class="form-control" id="formalOutput" name="message" rows="5"></textarea>
              </div>
            </div>
          </fieldset>
          </form>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Javascript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="js/taffy.js"></script>
  <script src="js/DAILIESDB.js"></script>
  <script>
  // ------------------------------------------------------------------
  // dice roller helper function
  function rollDie(dieSize) {
    return Math.floor((Math.random() * dieSize) + 1);
  }
  
  // ------------------------------------------------------------------
  // generate random index for selecting item obtained
  function rIndex(itemNum) {
    return Math.floor((Math.random() * itemNum));
  }
  
  // ------------------------------------------------------------------
  // function for calculating daily rolls
  function rollDaily() {
    var finalString = "";
    var e = document.getElementById("dailyType");
    var loc = document.getElementById("locationType").value;
    var dailyType = e.options[e.selectedIndex].value;
    var bonus = parseInt(document.getElementById("skillLevel").value);
    
    // Kumo and Lottie went Gathering in The Thickets.
    var formalString = "<small>";
    var sooshName = document.getElementById("sooshName").value;
    if (sooshName != "") {
      formalString += sooshName;
    } else {
      formalString += "SOOSHNAME";
    }
    formalString += " went ";
    formalString += e.value;
    formalString += " in ";
    formalString += loc;
    document.getElementById("formalOutput").innerHTML = formalString;
    
    // ------------------------------------------------------------------
    // crafting
    if (dailyType == "crafting") {
      result = rollDie(20) + bonus;
      finalString = result;
      finalString += ": ";
      if (result == 1) {
        finalString += "failure and negative debuff";
      } else if ((result >= 2) && (result <= 8)) {
        finalString += "straight failure";
      } else if ((result >= 9) && (result <= 12)) {
        finalString += "failure but creates new item";
      } else if ((result >= 13) && (result <= 19)) {
        finalString += "success";
      } else if (result >= 20) {
        finalString += "success and a buff for the next time they craft";
      }
    // ------------------------------------------------------------------
    // hunting and fishing
    } else if ((dailyType == "hunting") || (dailyType == "fishing")) {
      result = rollDie(20) + bonus;
      finalString = result;
      finalString += ": ";
      if (result == 1) {
        finalString += "failure and a dizziness debuff";
      } else if ((result >= 2) && (result <= 6)) {
        finalString += "straight failure";
      } else if ((result >= 7) && (result <= 12)) {
        var DBresults;
        if (dailyType == "fishing") {
          finalString += "gets a common fish\n";
          DBresults = anglingDB({location:loc,rarity:"common"}).select("name");
        } else {
          finalString += "gets a common animal\n";
          DBresults = huntingDB({location:loc,difficulty:"easy"}).select("name");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if ((result >= 13) && (result <= 16)) {
        var DBresults;
        if (dailyType == "fishing") {
          finalString += "gets an uncommon fish\n";
          DBresults = anglingDB({location:loc,rarity:"uncommon"}).select("name");
        } else {
          finalString += "gets an uncommon animal\n";
          DBresults = huntingDB({location:loc,difficulty:"medium"}).select("name");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if ((result >= 17) && (result <= 19)) {
        var DBresults;
        if (dailyType == "fishing") {
          finalString += "gets a rare fish\n";
          DBresults = anglingDB({location:loc,rarity:"rare"}).select("name");
        } else {
          finalString += "gets a rare animal\n";
          DBresults = huntingDB({location:loc,difficulty:"hard"}).select("name");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if (result >= 20) {
        var DBresults;
        if (dailyType == "fishing") {
          finalString += "gets a rare fish and a buff for the next time they go hunting\n";
          DBresults = anglingDB({location:loc,rarity:"rare"}).select("name");
        } else {
          finalString += "gets a rare animal and a buff for the next time they go hunting\n";
          DBresults = huntingDB({location:loc,difficulty:"hard"}).select("name");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      }
    // ------------------------------------------------------------------
    // mining and woodcutting
    } else if ((dailyType == "mining") || (dailyType == "woodcutting")) {
      result_one = rollDie(20) + bonus;
      result_two = rollDie(20);
      finalString = result_one;
      finalString += ",";
      finalString += result_two;
      finalString += ": ";
      if (result_one == 1) {
        finalString += "failure and a negative debuff";
      } else if ((result_one >= 2) && (result_one <= 6)) {
        finalString += "straight failure";
      } else if ((result_one >= 7) && (result_one <= 12)) {
        var DBresults;
        if (dailyType == "mining") {
          finalString += "gets QUANTITY common rocks\n";
          DBresults = miningDB({location:loc,rarity:"common"}).select("name");
        } else {
          finalString += "gets QUANTITY common wood\n";
          DBresults = woodcuttingDB({location:loc,difficulty:"easy"}).select("logName");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if ((result_one >= 13) && (result_one <= 16)) {
        var DBresults;
        if (dailyType == "mining") {
          finalString += "gets QUANTITY uncommon rocks\n";
          DBresults = miningDB({location:loc,rarity:"uncommon"}).select("name");
        } else {
          finalString += "gets QUANTITY uncommon wood\n";
          DBresults = woodcuttingDB({location:loc,difficulty:"medium"}).select("logName");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if ((result_one >= 17) && (result_one <= 19)) {
        var DBresults;
        if (dailyType == "mining") {
          finalString += "gets QUANTITY rare rocks\n";
          DBresults = miningDB({location:loc,rarity:"rare"}).select("name");
        } else {
          finalString += "gets QUANTITY rare wood\n";
          DBresults = woodcuttingDB({location:loc,difficulty:"hard"}).select("logName");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      } else if (result_one >= 20) {
        var DBresults;
        if (dailyType == "mining") {
          finalString += "gets QUANTITY rare rocks and a positive buff for the next time they go mining\n";
          DBresults = miningDB({location:loc,rarity:"rare"}).select("name");
        } else {
          finalString += "gets QUANTITY rare wood and a positive buff for the next time they go wood-cutting\n";
          DBresults = woodcuttingDB({location:loc,difficulty:"hard"}).select("logName");
        }
        finalString += DBresults[rIndex(DBresults.length)];
        finalString += " was picked."
      }
      if ((result_two >= 1) && (result_two <= 6)) {
        finalString = finalString.replace("QUANTITY","1");
      } else if ((result_two >= 6) && (result_two <= 10)) {
        finalString = finalString.replace("QUANTITY","2");
      } else if ((result_two >= 11) && (result_two <= 15)) {
        finalString = finalString.replace("QUANTITY","3");
      } else if ((result_two >= 16) && (result_two <= 19)) {
        finalString = finalString.replace("QUANTITY","4");
      } else if (result_two == 20) {
        finalString = finalString.replace("QUANTITY","5");
      }
    // ------------------------------------------------------------------
    // gathering
    } else if (dailyType == "gathering") {
      var DBresults;
      result_one = rollDie(20) + bonus;
      result_two = rollDie(6);
      result_three = rollDie(20);
      finalString = result_one;
      finalString += ",";
      finalString += result_two;
      finalString += ",";
      finalString += result_three;
      finalString += ": ";
      var rarityFlag;
      if (result_one == 1) {
        finalString += "failure and a negative debuff\n";
      } else if ((result_one >= 2) && (result_one <= 6)) {
        finalString += "straight failure\n";
      } else if ((result_one >= 7) && (result_one <= 12)) {
        finalString += "gets QUANTITY common ITEM\n";
        rarityFlag = "common";
      } else if ((result_one >= 13) && (result_one <= 16)) {
        finalString += "gets QUANTITY uncommon ITEM\n";
        rarityFlag = "uncommon";
      } else if ((result_one >= 17) && (result_one <= 19)) {
        finalString += "gets QUANTITY rare ITEM\n";
        rarityFlag = "rare";
      } else if (result_one >= 20) {
        finalString += "gets QUANTITY rare ITEM and a positive buff for the next time they go gathering\n";
        rarityFlag = "rare";
      }
      if (result_one >= 7) {
        if (result_two == 1) {
          finalString = finalString.replace("ITEM","flowers/plants");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"flower"}).select("name");
          DBresults = DBresults.concat(gatheringDB({location:loc,rarity:rarityFlag,type:"plant"}).select("name"));
        } else if (result_two == 2) {
          finalString = finalString.replace("ITEM","small animal items/drops");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"small animal items/drops"}).select("name");
        } else if (result_two == 3) {
          finalString = finalString.replace("ITEM","fruits/vegetables/berries");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"fruit"}).select("name");
          DBresults = DBresults.concat(gatheringDB({location:loc,rarity:rarityFlag,type:"vegetable"}).select("name"));
          DBresults = DBresults.concat(gatheringDB({location:loc,rarity:rarityFlag,type:"berry"}).select("name"));
        } else if (result_two == 4) {
          finalString = finalString.replace("ITEM","crafting items");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"crafting"}).select("name");
        } else if (result_two == 5) {
          finalString = finalString.replace("ITEM","miscellaneous items");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"miscellaneous"}).select("name");
        } else if (result_two == 6) {
          finalString = finalString.replace("ITEM","treasures");
          DBresults = gatheringDB({location:loc,rarity:rarityFlag,type:"treasures"}).select("name");
        }
        var numItems;
        if ((result_three >= 1) && (result_three <= 6)) {
          finalString = finalString.replace("QUANTITY","1");
          numItems = 1;
        } else if ((result_three >= 6) && (result_three <= 10)) {
          finalString = finalString.replace("QUANTITY","2");
          numItems = 2;
        } else if ((result_three >= 11) && (result_three <= 15)) {
          finalString = finalString.replace("QUANTITY","3");
          numItems = 3;
        } else if ((result_three >= 16) && (result_three <= 19)) {
          finalString = finalString.replace("QUANTITY","4");
          numItems = 4;
        } else if (result_three == 20) {
          finalString = finalString.replace("QUANTITY","5");
          numItems = 5;
        }
        if (DBresults.length > 0) {
          finalString += numItems;
          finalString += " ";
          finalString += DBresults[rIndex(DBresults.length)];
          finalString += " was picked."
        } else {
          finalString += "There are no items that are found in this location given skill and rarity generated";
        }
      }
    }
    document.getElementById("dailyOutput").innerHTML = finalString;
  }
  </script>
</body>
</html>